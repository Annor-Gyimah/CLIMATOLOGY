import xarray as xr
import matplotlib.pyplot as plt
import numpy as np

# define file path
file_path = 'daily_rainfall.nc' # replace with your own file path

# read in data as an xarray Dataset
ds = xr.open_dataset(file_path)

# compute number of dry and wet days per month
dry_wet_monthly = ds['rainfall'].groupby('time.month').agg([('dry', lambda x: (x < 1).sum()), ('wet', lambda x: (x >= 1).sum())])

# compute number of dry and wet days per year
dry_wet_yearly = ds['rainfall'].groupby('time.year').agg([('dry', lambda x: (x < 1).sum()), ('wet', lambda x: (x >= 1).sum())])

# create spatial map of wet days for first year
wet_days = (ds['rainfall'].sel(time='2000') >= 1).sum(dim='time')
wet_days.plot()

# create time-series plot of dry and wet days per year
fig, ax = plt.subplots()
dry_wet_yearly.plot(ax=ax, kind='line')
ax.set(xlabel='Year', ylabel='Number of Days', title='Dry and Wet Days per Year')
ax.legend(['Dry Days', 'Wet Days'])

plt.show()